!function(t){function e(t,e){return e=parseFloat(t.css(e)),isNaN(e)?0:e}function n(t){this.identifier=t}function r(t){this.constructor.call(this,t)}function i(t){this.constructor.call(this,t)}function o(t){this.constructor.call(this,t)}function u(t){this.constructor.call(this,t)}function a(){this.init=function(e,n){var r=this,n=t.extend({file_button:"Choose file",file_label:"No file chosen",responsive_select:!1,responsive_file:!1},n||{});return e=e.each(function(){if("SELECT"==this.nodeName&&this.size>0||this.$$custom_form_identifier)return!0;this.$$custom_form_identifier=r.new_element(this).init(n).identifier})},this.execute=function(t,e){var n=e[0],r=Array.prototype.slice.call(e,1);return n in l?l[n].apply(t,r):t.each(function(){if(this.$$custom_form_identifier){var t=s[this.$$custom_form_identifier].instance;t[n].apply(t,r)}})},this.new_element=function(e,r){var i=t(e),o=n.build(i,r),u=o.get_id();return this.register_instance(u,o,i),o},this.register_instance=function(t,e,n){s[t]={element:n,instance:e,children:{}}},this.unregister_instance=function(t){var e=t.get_id();t=t.kill(),delete s[e]}}var s={fn:{}},l={disabled:function(t){if(t!=undefined||(t="all"),1==this.length)return s[this[0].$$custom_form_identifier].instance.disabled(t);var e="any"!=t;return this.each(function(){var n=s[this.$$custom_form_identifier].instance.disabled(t);switch(t){case"all":if(e&&!n)return e=!1,!1;break;case"any":if(n)return e=!0,!1;break;case"none":if(!n)return e=!1,!1}}),e}};s._browser=t.browser||function(){var t,e,n;return n=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}},t=n(navigator.userAgent),e={},t.browser&&(e[t.browser]=!0,e.version=t.version),e.chrome?e.webkit=!0:e.webkit&&(e.safari=!0),e}(),n.total_instances=0,n.browser_string=function(){var t,e,n,r=s._browser;for(t in r)"version"==t?e=parseInt(r.version):n=t;return n+" "+n+e+(r.msie?"":" not_msie")}(),n.build=function(t){var e,r;if(e=t.is("select")?"select":"input_"+t.attr("type"),!(r=this.available_classes[e]))throw"No class available to build element of type "+e;return new r(e+"_"+n.total_instances++)},n.available_classes={},n.register_class=function(t,e){this.available_classes[t]=e};var c=n.prototype;t.extend(c,{is_disabled:!1,get_element:function(){return s[this.identifier].element},get:function(t){return s[this.identifier].children[t]},set:function(t,e){return s[this.identifier].children[e]=t,t},get_id:function(){return this.identifier},kill:function(){return this.identifier},active_replacement_class:function(t){this.replacement[t?"addClass":"removeClass"]("checked_"+this.element_type)},init:function(t){var e,r=this.get_element(),i=r.attr("id");return this.set_parameters(r,t),e=this.set_replacement(r),e.addClass(n.browser_string),i.match(/\S/)&&e.addClass("custom-form_"+i),this.replace_elements(r,e),this.init_replacement(r,e),this.disable_if_disabled(r),this.init_mouse_events(r,e),this},set_replacement:function(t){return this.set(this.get_replacement(t),"replacement")},init_mouse_events:function(t,e){var n,r=this.mouse_trigger();r.bind("mouseenter",this,this.hover_handler).bind("mouseleave",this,this.out_handler).bind("mouseup",this,this.mouse_up_handler).bind("mousedown",this,this.mouse_down_handler),n=e.parent("label"),0==n.length&&r.bind("click",this,this.click_handler),t.bind("focusin",this,this.focus_in).bind("focusout",this,this.focus_out).bind("change",this,this.change)},focus_in:function(t){t.data.focus(!0)},focus_out:function(t){t.data.focus(!1)},focus:function(t){this.is_disabled||this.get("replacement")[t?"addClass":"removeClass"]("focus_"+this.element_type)},change:function(){},label_handler:function(t){t.target==this&&(t.preventDefault(),t.data.get_element().triggerHandler("change"))},hover_handler:function(t){t.data.hover(!0)},out_handler:function(t){t.data.hover(!1)},mouse_up_handler:function(t){t.data.mouse_in(!1)},mouse_down_handler:function(t){t.data.mouse_in(!0)},hover:function(t){this.is_disabled||this.get("replacement")[t?"addClass":"removeClass"]("hover_"+this.element_type)},mouse_in:function(t){this.is_disabled||this.get("replacement")[t?"addClass":"removeClass"]("active_"+this.element_type)},disabled:function(t,e,n){var n,e=e||this.get_element();switch(t){case!0:case!1:return n=n||this.get("replacement"),e.attr("disabled",t),n[t?"addClass":"removeClass"]("disabled_"+this.element_type),this.is_disabled=t,t;case"none":return!e.is(":disabled");default:return e.is(":disabled")}},disable_if_disabled:function(t){this.is_disabled!=t.is(":disabled")&&this.disabled(!this.is_disabled,t)}}),r.IDENTIFIER="input_checkbox";var f=r.prototype=new n;f.constructor=n.prototype.constructor,t.extend(f,{element_type:"checkbox",uncheckeable:!1,set_parameters:function(t){this.element_id=t.attr("id"),this.element_name=t.attr("name")},get_replacement:function(){return t("<span class='"+this.element_type+"'></span>")},replace_elements:function(t,e){t.after(e),e.append(t)},init_replacement:function(t,e){var n,r;(n=t.is(":checked"))&&this.checked(!0,t,e),(r=t.is(":disabled"))&&this.disabled(!0,t,e),(n||r)&&this.update(t,e)},checked:function(t,e,n){e=e||this.get_element(),n=n||this.get("replacement"),t=t==undefined?!e.is(":checked"):t,(!this.uncheckeable||this.uncheckeable&&t)&&(e.prop("checked",t),e.trigger("change"))},mouse_trigger:function(){return this.get("replacement")},click_handler:function(t){if(!t.data.is_disabled){var e=t.data;e.get_element().focus().triggerHandler("click"),t.target==this&&e.checked()}},change:function(e){e.data.update(t(this))},update:function(t,e){var t=t||this.get_element(),n="checked_"+this.element_type,r=t.is(":checked"),e=e||this.get("replacement");this.disable_if_disabled(t),r&&!e.hasClass(n)?e.addClass(n):!r&&e.hasClass(n)&&e.removeClass(n)}}),n.register_class(r.IDENTIFIER,r),i.IDENTIFIER="input_radio";var d=i.prototype=new r;d.constructor=n.prototype.constructor,t.extend(d,{uncheckeable:!0,element_type:"radio",update:function(e,n){var e=e||this.get_element(),r="checked_"+this.element_type,i=e.is(":checked"),n=n||this.get("replacement");if(this.disable_if_disabled(e),i){var o=t("."+r).has("[name='"+this.element_name+"']").not(this.element_id);0!=o.length&&o.removeClass(r),n.addClass(r)}}}),n.register_class(i.IDENTIFIER,i),n.element_border_width=function(t){return parseInt(t.css("border-left-width"))-parseInt(t.css("border-right-width"))},o.IDENTIFIER="select";var h=o.prototype=new n;h.constructor=n.prototype.constructor,t.extend(h,{button_width:0,click_handler:t.noop,element_type:"select",redraw:function(){var n=this.get_element();n.removeAttr("style"),this.element_width=n.outerWidth();var r=this.get("replacement"),i=r.find(".select_content"),o=this.set(t(".select_label",r),"select_label"),u={width:this.element_width-e(r,"border-left-width")-e(r,"border-right-width")};n.css(u),r.css(u);var a=t(".select_button",r);o.css({width:u.width-a.outerWidth()-e(i,"border-left-width")-e(i,"border-right-width")-e(o,"border-right-width")-e(o,"border-left-width")})},set_parameters:function(t,e){this.responsive=e.responsive_select},get_replacement:function(e){var n=t("option:selected",e);return 0!=n.length||(n=t("option:first-child",e)),t("<span class='select'><span class='select_content' ><span class='select_button'><span class='select_button_icon'></span></span><span class='select_label'><span>"+n.text()+"</span></span></span></span>")},replace_elements:function(t,e){this.element_width=t.outerWidth(),t.after(e),e.append(t)},init_replacement:function(e,n){this.set(t(".select_label",n),"select_label");this.responsive?n.addClass("responsive_select"):this.redraw(),e.bind("change",this,this.select_change)},init_mouse_events:function(t,e){n.prototype.init_mouse_events.call(this,t,e),(s._browser.mozilla||s._browser.msie)&&t.bind("keyup",this,this.key_up)},key_up:function(t){38!=t.which&&40!=t.which||t.data.update()},select_change:function(t){t.data.update_label()},update_label:function(){this.get("select_label").html("<span>"+t("option:selected",this.get_element()).text()+"</span>")},mouse_trigger:function(){return this.get_element()},update:function(){var t=this.get_element();this.disable_if_disabled(t),t.trigger("change")},select:function(e){var n=typeof e,r=this.get_element();switch(n){case"number":r.val(t(":nth-child("+e+")",r).val());break;case"function":e.apply(r);break;default:"string"==n||(e=e.to_s),r.find("option:contains('"+e+"')").prop("selected",!0)}this.update()}}),n.register_class(o.IDENTIFIER,o),u.IDENTIFIER="input_file";var p=u.prototype=new n;p.constructor=n.prototype.constructor,t.extend(p,{click_handler:t.noop,element_type:"file",set_parameters:function(t,e){this.label=e.file_label,this.button_label=e.file_button,this.responsive=e.responsive_file},get_replacement:function(){return t("<span class='file'><span class='file_content'><span class='file_button'><span></span>"+this.button_label+"</span><span class='file_label'><span>"+this.label+"</span></span></span></span>")},replace_elements:function(e,n){this.responsive||(this.element_width=e.outerWidth(),this.element_margin=e.css("margin-left"),this.element_padding=e.css("padding-left")),e.after(n);var r=t("<span class='file_wrap'></span>");n.append(r),r.append(e)},init_replacement:function(e,n){this.set(t(".file_label",n),"file_label");if(e.bind("change",this,this.file_change),this.responsive)n.addClass("responsive_file");else{var r={width:this.element_width-parseInt(n.css("border-left-width"))-parseInt(n.css("border-right-width"))};e.css(r),n.css(r)}},mouse_trigger:function(){return this.get_element()},file_change:function(t){t.data.update_label()},update_label:function(){var t=this.get_element().val();t.match(/\S/)||(t=this.label),this.get("file_label").html("<span>"+t+"</span>")},update:function(){var t=this.get_element();this.disable_if_disabled(t),t.trigger("change")}}),n.register_class(u.IDENTIFIER,u),s.fn.ie6=function(){return s._browser.msie&&parseInt(s._browser.version)<=6},s.fn.ie6_instance=function(){return new function(){this.init=this.execute=function(t){return t}}},a.get_custom_form_instance=function(){return this.instance||(this.instance=s.fn.ie6()?s.fn.ie6_instance():new a),this.instance},t.fn.custom_form=function(t){var e=a.get_custom_form_instance();return"string"==typeof t&&t?e.execute(this,arguments):e.init(this,t)}}(jQuery);